<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	 xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head>
        <title>Create Book</title>
    </h:head>
<h:body>
<rich:popupPanel id="createBook"  autosized="true" style="width:600px; height:300px">
<f:facet name="header">
<h:outputLabel value="Create new book" />
</f:facet>
<h:form id="createBookForm" >

    <h:panelGrid columns="3" >
    
    	<h:outputLabel value="Name:" />
   		<h:inputText label="Name" value="#{createBookAction.bookName}" id="name" required="true" requiredMessage="Book name is required" >
    		<f:validateLength minimum="3"  />
    	</h:inputText>
    	<rich:message for="name" ajaxRendered="true" />
    
    	<h:outputLabel value="Publisher:" />
    	<h:inputText label="Publisher" value="#{createBookAction.publisher}" />
    	<rich:message for="publisher" ajaxRendered="true" />
    
    	<h:outputLabel value="Year:" />
    	<h:inputText label="Year" id="year" value="#{createBookAction.yearPublished}" >
    		<f:validateLength minimum="4" maximum="4"  />
    		<f:validateLongRange minimum="1700"></f:validateLongRange>
    	</h:inputText>
    	<rich:message for="year" ajaxRendered="true" />
    
    	<h:outputLabel value="ISBN number:" />
   			<h:inputText required="true" label="ISBN" id="isbn" value="#{createBookAction.isbn}" validator="#{createBookAction.validateISBN}">
    	</h:inputText>
    	<rich:message for="isbn" ajaxRendered="true" />
    </h:panelGrid>
    

	<a4j:commandButton id="addBook" value="Add" action="#{createBookAction.submit()}" 
	oncomplete="if (#{createBookAction.createDone} == true) {#{rich:component('createBook')}.hide(); #{rich:component('confirmAdd')}.show();}"/>
    
    <h:commandButton   value="Add/Edit"  >
    <a4j:ajax execute="@form" listener="#{createBookAction.submit()}" oncomplete="form"></a4j:ajax>
    </h:commandButton>
    
    <h:commandButton type="reset"  value="Clear" >
        <f:ajax  execute="@this" listener="#{createBookAction.reset}" render="createBookForm" ></f:ajax>
    </h:commandButton>
    
    <h:commandButton type="button" value="Cancel" >
        <f:ajax  event="click" onevent="#{rich:component('createBook')}.hide()"></f:ajax>
    </h:commandButton>
</h:form>   

</rich:popupPanel>


<rich:popupPanel id="confirmAdd">
<h:outputText value="Book has been created" />
 <br/>
<a4j:commandButton value="OK" 
	oncomplete="#{createBookAction.reset()}; #{rich:component('confirmAdd')}.hide();"/>
</rich:popupPanel>
</h:body>
</html>