<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	 xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head>
        <title>Edit Book</title>
    </h:head>
 <h:body>
<f:metadata>
    <f:viewParam name="id" value="#{editBookAction.idBook}"/>
    <f:viewAction action="#{editBookAction.loadBook}"/>
</f:metadata>

<h:form id="editBookForm" >
<h:panelGrid columns="3" >
<f:facet name="header">
<h:outputLabel value="Edit book" />
</f:facet>
    
    	<h:outputLabel value="Name:" />
   		<h:inputText label="Name" value="#{editBookAction.book.bookName}" id="name" required="true" requiredMessage="Book name is required" >
    		<f:validateLength minimum="3"  />
    	</h:inputText>
    	<rich:message for="name" ajaxRendered="true" />
    
    	<h:outputLabel value="Publisher:" />
    	<h:inputText label="Publisher" value="#{editBookAction.book.publisher}" />
    	<rich:message for="publisher" ajaxRendered="true" />
    
    	<h:outputLabel value="Year:" />
    	<h:inputText label="Year" id="year" value="#{editBookAction.book.yearPublished}" >
    		<f:validateLength minimum="4" maximum="4"  />
    		<f:validateLongRange minimum="1700"></f:validateLongRange>
    	</h:inputText>
    	<rich:message for="year" ajaxRendered="true" />
    
    	<h:outputLabel value="ISBN number:" />
   			<h:inputText required="true" label="ISBN" id="isbn" value="#{editBookAction.book.isbn}" validator="#{createBookAction.validateISBN}">
    	</h:inputText>
    	<rich:message for="isbn" ajaxRendered="true" />
    	
    	<h:outputLabel value="Authors:" />
    <rich:list  id="listAuthors" value="#{editBookAction.authors}" var="author">
    	<h:panelGrid columns="3">
   			<h:outputText value="#{author.firstName}" />
     		<h:outputText value="#{author.secondName}" />
     		<h:commandButton action="#{editBookAction}" value="Remove" />
    	</h:panelGrid>
   	</rich:list>
       
    </h:panelGrid>
   
    
    
    
<rich:collapsiblePanel id="panel" header="Add Authors" switchType="ajax" >
<h:panelGrid columns="2">
    <h:outputLabel value="Author:" />
     <h:commandButton  actionListener="#{editBookAction.checkIfAuthorExist}"  value="add Author" >
    <f:ajax execute="panel" render="listAuthors"></f:ajax>
     <f:ajax render="messages"/>
     </h:commandButton>


	 <h:outputLabel value="Second name" />
	 <rich:autocomplete mode="cachedAjax" tokens=", " minChars="2" value="#{editBookAction.secondName}" autofill="false"
            autocompleteMethod="#{editBookAction.autocompleteSecondName}" ></rich:autocomplete>
      
      <h:outputLabel value="First name" />
      <rich:autocomplete  mode="cachedAjax" tokens=", " minChars="1" value="#{editBookAction.firstName}" autofill="false"
            autocompleteMethod="#{editBookAction.autocompleteFirstName}" >

            </rich:autocomplete>
           
    
</h:panelGrid>
   <h:messages id="messages"/>
</rich:collapsiblePanel>

<a4j:commandButton id="editBook" value="Edit" action="#{editBookAction.submit()}" 
	oncomplete="if (#{createBookAction.createDone} == true) {#{rich:component('createBook')}.hide(); #{rich:component('confirmAdd')}.show();}"/>
	
    <h:commandButton type="reset"  value="Clear" >
        <f:ajax  execute="@this" listener="#{editBookAction.loadBook()}" render="editBookForm" ></f:ajax>
    </h:commandButton>
    
    <h:commandButton type="button" value="Cancel" >
        <f:ajax  event="click" onevent="#{rich:component('createBook')}.hide()"></f:ajax>
    </h:commandButton>


    

</h:form>

</h:body>
</html>