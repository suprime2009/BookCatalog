<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	 xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head>
        <title>Edit Book</title>
    </h:head>
 <h:body>
<f:metadata>
    <f:viewParam name="id" value="#{editBookAction.idBook}"/>
    <f:viewAction action="#{editBookAction.loadBook}"/>
</f:metadata>

<h:form id="editBookForm" >


   <ui:include src="inserts/inputsBookCreate.xhtml" >
   <ui:param name="bean" value="#{editBookAction}" />
   </ui:include>
   
 <h:outputLabel value="Authors :" />
 <br/>

 <rich:list id="listAuthors" value="#{editBookAction.authors}" var="author" >
 <h:outputText value="#{author.firstName} #{author.secondName}  " />
 <h:commandButton  value="Remove" actionListener="#{editBookAction.removeAuthor}">
  <f:ajax execute="listAuthors"  render="listAuthors" > </f:ajax>
  <f:attribute name="secondName" value="#{author.secondName}"></f:attribute>
  <f:attribute name="firstName" value="#{author.firstName}"></f:attribute>
 
  </h:commandButton>
 </rich:list>  

<rich:collapsiblePanel id="panel" header="Add Authors" switchType="client" style="width:300px;">

<h:panelGrid columns="2">
    <h:outputLabel value="Author:" />
     <h:commandButton  actionListener="#{editBookAction.checkIfAuthorExist}"  value="add Author" >
    <f:ajax execute="panel" render="listAuthors"></f:ajax>
     <f:ajax render="messages"/>
     </h:commandButton>


	 <h:outputLabel value="Second name" />
	 <rich:autocomplete mode="cachedAjax" tokens=", " minChars="2" value="#{editBookAction.secondName}" autofill="false"
            autocompleteMethod="#{editBookAction.autocompleteSecondName}" ></rich:autocomplete>
      
      <h:outputLabel value="First name" />
      <rich:autocomplete  mode="cachedAjax" tokens=", " minChars="1" value="#{editBookAction.firstName}" autofill="false"
            autocompleteMethod="#{editBookAction.autocompleteFirstName}" >
            </rich:autocomplete>

</h:panelGrid>
   <h:messages id="messages"/>
</rich:collapsiblePanel>


	
	<h:commandButton value="Edit" action="#{editBookAction.submit()}"> </h:commandButton>
	
    <h:commandButton type="reset"  value="Clear" >
        <f:ajax  execute="@this" listener="#{editBookAction.loadBook()}" render="editBookForm" ></f:ajax>
    </h:commandButton>
  
    <h:button value="Cancel" outcome="#{navigationAction.moveToManageBooks()}"></h:button>

</h:form>

</h:body>
</html>